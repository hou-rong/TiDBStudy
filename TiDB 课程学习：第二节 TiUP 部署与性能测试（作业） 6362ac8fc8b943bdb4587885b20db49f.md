# TiDB 课程学习：第二节 TiUP 部署与性能测试（作业）

# 部署机器

## 部署机器配置

- 虚拟机 CPU 1 核，物理机 2.2 GHz Intel Core i7
- 虚拟机 内存 2048 MB，物理机 16 GB 1600 MHz DDR3
- 虚拟机 20GB SSD，物理机 磁盘 Macintosh HD

## 拓扑结构

最简部署，tiup 配置文件如下

```bash
# # Global variables are applied to all deployments and used as the default value of
# # the deployments if a specific deployment value is missing.
global:
  user: "root"
  ssh_port: 22
  deploy_dir: "/tidb-deploy"
  data_dir: "/tidb-data"

pd_servers:
  - host: 10.211.55.10

tidb_servers:
  - host: 10.211.55.11

tikv_servers:
  - host: 10.211.55.12

monitoring_servers:
  - host: 10.211.55.13

grafana_servers:
  - host: 10.211.55.13

alertmanager_servers:
  - host: 10.211.55.13
```

# sysbench 测试

完成如下配置

```bash
mysql-host=10.211.55.11
mysql-port=4000
mysql-user=root
mysql-password=
mysql-db=test_sysbench
time=600
threads=16
report-interval=10
db-driver=mysql
```

通过如下命令，添加测试数据

```bash
sysbench --config-file=config oltp_point_select --tables=32 --table-size=10000 prepare
```

执行如下测试命令

```bash
# Point select 测试命令
sysbench --config-file=config oltp_point_select --threads=16 --tables=32 --table-size=10000 run

# Update index 测试命令
sysbench --config-file=config oltp_update_index --threads=16 --tables=32 --table-size=10000 run

# Read-only 测试命令
sysbench --config-file=config oltp_read_only --threads=16 --tables=32 --table-size=10000 run
```

## 测试结果

### oltp_point_select

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled.png)

### oltp_update_index

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%201.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%201.png)

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%202.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%202.png)

### oltp_read_only

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%203.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%203.png)

## 整体图表

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%204.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%204.png)

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%205.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%205.png)

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%206.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%206.png)

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%207.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%207.png)

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%208.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%208.png)

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%209.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%209.png)

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2010.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2010.png)

# go-ycsb 性能测试

## 安装

```bash
git clone https://github.com/pingcap/go-ycsb.git
make
```

## 进行测试

```bash
# 测试命令
./bin/go-ycsb load mysql -P workloads/workloada -p recordcount=1000000 -p mysql.host=10.211.55.11 -p mysql.port=4000 --threads 16
```

## 测试结果

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2011.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2011.png)

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2012.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2012.png)

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2013.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2013.png)

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2014.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2014.png)

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2015.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2015.png)

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2016.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2016.png)

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2017.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2017.png)

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2018.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2018.png)

# go-tpc

## 测试准备

```bash
git clone https://github.com/pingcap/go-tpc.git
make build
```

## 测试命令

```bash
# 准备命令
./bin/go-tpc tpcc -H 10.211.55.11 -P 4000 -D tpcc --warehouses 1000 prepare
# 测试命令
./bin/go-tpc tpcc -H 10.211.55.11 -P 4000 -D tpcc --warehouses 1000 run
```

## 测试结果

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2019.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2019.png)

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2020.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2020.png)

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2021.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2021.png)

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2022.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2022.png)

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2023.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2023.png)

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2024.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2024.png)

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2025.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2025.png)

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2026.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2026.png)

# 结论

![TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2027.png](TiDB%20%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%20TiUP%20%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89%206362ac8fc8b943bdb4587885b20db49f/Untitled%2027.png)

当前几次性能测试后，其中 TiDB 机器 10.211.55.12 机器的 CPU 明显高于其他机器，此时该机器承担的职责为 TiKV。压力主要集中在 TiKV 上，对该机器扩容，从 CPU 1 → 更多，会有明显的改善